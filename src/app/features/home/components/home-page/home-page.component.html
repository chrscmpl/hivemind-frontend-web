@let isMobile = breakpoints.isMobile();

<div class="h-full flex flex-col">
  <div
    class="sticky z-10 top-0 left-0 gap-4 flex-wrap px-4 bg-background-base-alt min-h-20 flex items-center max-w-[100vw] overflow-hidden app-home-nav"
  >
    <app-feed-selector
      [formControl]="feedControl"
      ngDefaultControl
      buttonAppearance="secondary-grayscale"
    />

    <app-age-selector
      [formControl]="ageControl"
      ngDefaultControl
      buttonAppearance="secondary-grayscale"
    />
  </div>
  <tui-carousel
    [index]="index"
    (indexChange)="onCarouselChange($event)"
    [draggable]="isMobile"
    class="!min-h-0 max-w-[100vw] !h-full flex-1"
  >
    @for (feed of feeds; track $index) {
      <div *tuiItem class="!relative h-full">
        <tui-scrollbar
          class="!absolute !top-0 !left-0 !w-full !min-h-0 !h-full !pb-4"
          [hidden]="isMobile"
          [class.w-screen]="isMobile"
        >
          <div class="flex justify-center" [class.pr-12]="!isMobile">
            <div class="w-full" [class.max-w-3xl]="!isMobile">
              @if (feed.fetch) {
                <app-idea-feed
                  [sort]="feed.sort"
                  [key]="feed.sort"
                  [age]="ageControl.value"
                  [page]="1"
                  [limit]="10"
                  includeOwnVotes
                  includeUsers
                />
              }
              <tui-loader
                [showLoader]="true"
                size="xxl"
                [inheritColor]="true"
                class="text-background-neutral-1"
              />
            </div>
          </div>
        </tui-scrollbar>
      </div>
    }
  </tui-carousel>
</div>
